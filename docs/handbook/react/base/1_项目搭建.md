---
title: vite+react+tsé¡¹ç›®æ­å»º
author: èµµä¸‰ä¸‰
date: '2023-8-25'
sidebar: auto
# sticky: 1
tags:
 - react
categories:
 - react
---

::: tip
viteéœ€è¦Nodeç‰ˆæœ¬>=12.0.0ï¼Œå¦‚æœä½ çš„åŒ…ç®¡ç†å™¨å‘å‡ºè­¦å‘Šï¼Œè¯·æ³¨æ„å‡çº§ä½ çš„Nodeç‰ˆæœ¬
:::

## æ­å»º

```
npm create vite@latest my-vite-app
```
![é¡¹ç›®æ­å»ºé€‰é¡¹](../../../.vuepress/public/imgs/create-react-1.png)
![é¡¹ç›®æ­å»ºé€‰é¡¹](../../../.vuepress/public/imgs/create-react-2.png)
```
cd my-vite-app
npm install
npm run dev
```

### è®¾ç½®srcåˆ«å
- ä¿®æ”¹vite.config.ts
```
export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': '/src'
    }
  }
})
```
- ä¿®æ”¹tsconfig.json
```
"compilerOptions": {
  "baseUrl": "./",
  "paths": {
    "@/*": [
      "src/*"
    ]
  }
}
```
![tsè­¦å‘Š](../../../.vuepress/public/imgs/paths.png)

### Routeræ­å»º
- ä½¿ç”¨ `react-router-dom` [ğŸ‘‰æˆ³è¿™é‡Œ](https://reactrouter.com/en/main/routers/create-browser-router)
   - å®‰è£… react-router-dom `npm install react-router-dom`
- å…¥å£æ–‡ä»¶
  [ğŸ‘‰æˆ³è¿™é‡Œ](https://reactrouter.com/en/main/routers/router-provider)
```
// App.tsx

import './App.css'
import { RouterProvider } from 'react-router-dom'
import Routes from '@/router/routes'
// ğŸ‘‰ åœ¨srcä¸‹å¯ä»¥æ–°å»ºrouteræ–‡ä»¶å¤¹ï¼Œç”¨äºæ”¾ç½®è·¯ç”±ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å†™åœ¨æ­¤æ–‡ä»¶å†…

function App() {
  // ğŸ‘‰ RouterProviderï¼šæ‰€æœ‰çš„è·¯ç”±å¯¹è±¡éƒ½éœ€è¦æ­¤ç»„ä»¶æ¥æ¸²æŸ“åº”ç”¨
  return <RouterProvider router={ Routes } />
}
```
- AppæŒ‚è½½
```
// main.tsx - è‡ªåŠ¨ç”Ÿæˆ

import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App.tsx'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
)
```
- è·¯ç”±
   - createBrowserRouterï¼šv6çš„apiï¼Œåœ¨reacté¡¹ç›®ä¸­å»ºè®®ä½¿ç”¨routerï¼Œä»–åº•å±‚æ˜¯ç”¨ DOM History API å¯¹URLçš„æ›´æ–°ç®¡ç†ï¼Œå­˜å‚¨åœ¨å¯¹åº”çš„ history æ ˆ
   - è·¯ç”±API ï¼š 
     - BrowseRouter ï¼šç”¨äºæµè§ˆå™¨è·¯ç”±æ¨¡å¼ï¼ˆå†å²è®°å½•æ¨¡å¼ï¼‰
     - HashRouter ï¼šç”¨äºåˆ‡æ¢è·¯ç”±æ¨¡å¼ï¼ˆå“ˆå¸Œæ¨¡å¼ï¼‰
   - routeï¼šå°†`url`å’Œ`ç»„ä»¶`è¿æ¥èµ·æ¥
     - åœ¨v6ä¸­ä½¿ç”¨Routeï¼Œå¤–å±‚å¿…é¡»åŠ ä¸ŠRoutesç»„ä»¶ï¼Œå³Routes->Route
```
import { createBrowserRouter } from "react-router-dom"

const Routes = createBrowserRouter([
  {
    path: "/",
    element: <Root />,
    errorElement: <ErrorPage />,
    loader: rootLoader,
    action: rootAction,
    children: [
      {
        // ğŸ‘‰ æ ¹æ®å†’æ³¡å°±è¿‘åŸåˆ™ï¼Œå†åµŒå¥—ä¸€å±‚å­è·¯ç”±ï¼Œå°†errorElementå±æ€§ç»Ÿä¸€æ”¾åœ¨æ ¹å­è·¯ç”±ä¸Šï¼Œæ­¤æ—¶é”™è¯¯é¡µé¢ä¼šåœ¨æ ¹å‡ºå£ä¸­å‘ˆç°
        errorElement: <ErrorPage />,
        children: [
          { index: true, element: <Index /> },
          {
            path: "contacts/:contactId",
            element: <Contact />,
            loader: contactLoader,
            action: contactAction
          },
          {
            path: "contacts/:contactId/destroy",
            action: destroyAction,
            errorElement: <div>Oops! There was an error.</div>
          }
        ]
      }
    ]
  }
])
```
- pathï¼šè·¯ç”±åœ°å€
- elementï¼šå½“å‰è·¯å¾„çš„é¡µé¢
- errorElementï¼šé”™è¯¯é¡µé¢ï¼ˆå†’æ³¡å°±è¿‘åŸåˆ™ï¼‰
   - å¦‚æœåœ¨å­è·¯ç”±:
     - æœªæ·»åŠ  errorElement å±æ€§æ—¶ï¼Œä»–ä¼šæ‰¾åˆ°æ ¹è·¯ç”±çš„ errorElement
     - æ·»åŠ æœ‰ errorElement å±æ€§æ—¶ï¼Œä»–ä¼šæ‰¾åˆ°è‡ªå·±çš„ errorElement
- loaderï¼šæ¯ä¸ªè·¯ç”±éƒ½å¯ä»¥å®šä¹‰ä¸€ä¸ªâ€˜loaderâ€™å‡½æ•°ï¼Œåœ¨æ¸²æŸ“ä¹‹å‰ä¸ºrouteå…ƒç´ æä¾›æ•°æ®
- actionï¼šæ–¹æ³•ï¼Œä»…åœ¨ä½¿ç”¨æ•°æ®è·¯ç”±å™¨ï¼ˆå¦‚createBrowserRouterï¼‰æ—¶æœ‰æ•ˆ
- childrenï¼šå­è·¯ç”±